import{E as e,a as t,c as n,l as r,o as i,s as a,t as o,u as s,y as c}from"./logger-A9pt5B3e.js";import{i as l,n as u,t as d}from"./state-keys-ChuKo2jK.js";var f=e(c(),1);async function p(e={}){let c=e.logger??o({phase:`post`}),p=e.cacheAdapter??u,m=f.getState(d.SHOULD_SAVE_CACHE),h=f.getState(d.CACHE_SAVED),g=f.getState(d.SESSION_ID)||null;if(c.debug(`Post-action state`,{shouldSaveCache:m,cacheSaved:h,sessionId:g}),m!==`true`){c.info(`Skipping post-action: event was not processed`,{shouldSaveCache:m});return}if(h===`true`){c.info(`Skipping post-action: cache already saved by main action`,{cacheSaved:h});return}try{await l({components:{agentIdentity:`github`,repo:i(),ref:t(),os:s()},runId:a(),logger:c,storagePath:r(),authPath:n(),cacheAdapter:p})?c.info(`Post-action cache saved`,{sessionId:g}):c.info(`Post-action: no cache content to save`,{sessionId:g})}catch(e){c.warning(`Post-action cache save failed (non-fatal)`,{error:e instanceof Error?e.message:String(e)})}}await p();export{p as runPost};