import{E as e,a as t,c as n,l as r,o as i,s as a,t as o,u as s,y as c}from"./logger-A9pt5B3e.js";import{r as l,t as u}from"./state-keys-Dfv-R-Ta.js";var d=e(c(),1);async function f(e={}){let c=e.logger??o({phase:`post`}),f=d.getState(u.SHOULD_SAVE_CACHE),p=d.getState(u.CACHE_SAVED),m=d.getState(u.SESSION_ID)||null;if(c.debug(`Post-action state`,{shouldSaveCache:f,cacheSaved:p,sessionId:m}),f!==`true`){c.info(`Skipping post-action: event was not processed`,{shouldSaveCache:f});return}if(p===`true`){c.info(`Skipping post-action: cache already saved by main action`,{cacheSaved:p});return}try{await l({components:{agentIdentity:`github`,repo:i(),ref:t(),os:s()},runId:a(),logger:c,storagePath:r(),authPath:n()})?c.info(`Post-action cache saved`,{sessionId:m}):c.info(`Post-action: no cache content to save`,{sessionId:m})}catch(e){c.warning(`Post-action cache save failed (non-fatal)`,{error:e instanceof Error?e.message:String(e)})}}await f();export{f as runPost};